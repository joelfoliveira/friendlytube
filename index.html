<html>
    <head>
        <meta charset="UTF-8">
    </head>
    <body>
        <h1>Friendly Tube</h1>

        <div id="playlists"></div>
        <div id="videos"></div>

        <div id="player"></div>

        
        <script>

            const data = 
            {
                playlists: [
                    {
                        name: "Dança",
                        icon: "",
                        videos: [
                            {
                                name: "video 1",
                                thumbnail: "",
                                video: "QBK6xymmKHM"
                            },
                            {
                                name: "video 2",
                                thumbnail: "",
                                video: "8AHCfZTRGiI"
                            }
                        ]
                    },
                    {
                        name: "Música",
                        icon: "",
                        videos: [
                            {
                                name: "video 3",
                                thumbnail: "",
                                video: "GilzbcZOcHU"
                            },
                            {
                                name: "video 4",
                                thumbnail: "",
                                video: "NWU33fvPxd0"
                            }
                        ]
                    }
                ]
            };

            document.addEventListener("DOMContentLoaded", function() {
                displayPlaylists();
            });

            var videoPlayer = document.getElementById("player");
            var playlistHolder = document.getElementById("playlists");
            var videosHolder = document.getElementById("videos");

            
            function displayPlaylists()
            {
                for(let i = 0; i < data.playlists.length; i++) 
                {
                    let playlist = data.playlists[i];

                    const button = document.createElement("button");

                    button.onclick = function(){ loadVideos(i) };

                    const text = document.createTextNode(playlist.name);
                    button.appendChild(text);

                    playlistHolder.appendChild(button);
                }

                loadVideos(0);
            }

            function loadVideos(playlistIndex)
            {
                videosHolder.innerHTML = "";

                var playlist = data.playlists[playlistIndex];

                for(let j = 0; j < playlist.videos.length; j++) 
                {
                    let video = playlist.videos[j];

                    const button = document.createElement("button");

                    button.onclick = function(){ playVideo(playlistIndex, j) };

                    const text = document.createTextNode(video.name);
                    button.appendChild(text);

                    videosHolder.appendChild(button);
                }

                playVideo(playlistIndex, 0);
            }

            function playVideo(playlistIndex, videoIndex)
            {

                var videos =  data.playlists[playlistIndex].videos.map(function(item){
                    return item.video;
                });

                player.loadPlaylist({playlist: videos, index: videoIndex});
                player.setLoop(1);
                
            }


            var tag = document.createElement('script');

            tag.src = "https://www.youtube.com/iframe_api";
            var firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

            var player;
            function onYouTubeIframeAPIReady() {

                player = new YT.Player('player', {
                    height: '390',
                    width: '640',
                    videoId: data.playlists[0].videos[0].video,
                    playerVars: {
                        'playsinline': 1,
                        'controls': 0,
                        'disablekb': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });                
            }
            
            function onPlayerReady(event) {                
                
            }

            function onPlayerStateChange(event) {
                
            }
        </script>
    </body>
</html>